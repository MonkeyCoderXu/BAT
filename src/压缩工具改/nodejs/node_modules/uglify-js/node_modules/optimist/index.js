function Argv(e,n){function r(e){a.showHelp(),e&&console.error(e),process.exit(1)}function t(){function n(e,n){var r=Number(n),o="string"!=typeof n||isNaN(r)?n:r;i.strings[e]&&(o=n),setKey(t,e.split("."),o),(c[e]||[]).forEach(function(n){t[n]=t[e]})}var t={_:[],$0:a.$0};Object.keys(i.bools).forEach(function(e){n(e,f[e]||!1)});for(var o=0;o<e.length;o++){var l=e[o];if("--"===l){t._.push.apply(t._,e.slice(o+1));break}if(l.match(/^--.+=/)){var p=l.match(/^--([^=]+)=([\s\S]*)$/);n(p[1],p[2])}else if(l.match(/^--no-.+/)){var h=l.match(/^--no-(.+)/)[1];n(h,!1)}else if(l.match(/^--.+/)){var h=l.match(/^--(.+)/)[1],g=e[o+1];void 0===g||g.match(/^-/)||i.bools[h]||(c[h]?i.bools[c[h]]:0)?/^(true|false)$/.test(g)?(n(h,"true"===g),o++):n(h,!0):(n(h,g),o++)}else if(l.match(/^-[^-]+/)){for(var v=l.slice(1,-1).split(""),b=!1,y=0;y<v.length;y++){if(v[y+1]&&v[y+1].match(/\W/)){n(v[y],l.slice(y+2)),b=!0;break}n(v[y],!0)}if(!b){var h=l.slice(-1)[0];!e[o+1]||e[o+1].match(/^-/)||i.bools[h]||(c[h]?i.bools[c[h]]:0)?e[o+1]&&/true|false/.test(e[o+1])?(n(h,"true"===e[o+1]),o++):n(h,!0):(n(h,e[o+1]),o++)}}else{var d=Number(l);t._.push(i.strings._||isNaN(d)?l:d)}}Object.keys(f).forEach(function(e){e in t||(t[e]=f[e],e in c&&(t[c[e]]=f[e]))}),s._&&t._.length<s._&&r("Not enough non-option arguments: got "+t._.length+", need at least "+s._);var m=[];return Object.keys(s).forEach(function(e){t[e]||m.push(e)}),m.length&&r("Missing required arguments: "+m.join(", ")),u.forEach(function(e){try{e(t)===!1&&r("Argument check failed: "+e.toString())}catch(n){r(n)}}),t}function o(e){return Math.max.apply(null,e.map(function(e){return e.length}))}var a={};n||(n=process.cwd()),a.$0=process.argv.slice(0,2).map(function(e){var r=rebase(n,e);return e.match(/^\//)&&r.length<e.length?r:e}).join(" "),void 0!=process.env._&&process.argv[1]==process.env._&&(a.$0=process.env._.replace(path.dirname(process.execPath)+"/",""));var i={bools:{},strings:{}};a.boolean=function(e){return Array.isArray(e)||(e=[].slice.call(arguments)),e.forEach(function(e){i.bools[e]=!0}),a},a.string=function(e){return Array.isArray(e)||(e=[].slice.call(arguments)),e.forEach(function(e){i.strings[e]=!0}),a};var c={};a.alias=function(e,n){if("object"==typeof e)Object.keys(e).forEach(function(n){a.alias(n,e[n])});else if(Array.isArray(n))n.forEach(function(n){a.alias(e,n)});else{var r=(c[e]||[]).concat(c[n]||[]).concat(e,n);c[e]=r.filter(function(n){return n!=e}),c[n]=r.filter(function(e){return e!=n})}return a};var s={};a.demand=function(e){return"number"==typeof e?(s._||(s._=0),s._+=e):Array.isArray(e)?e.forEach(function(e){a.demand(e)}):s[e]=!0,a};var l;a.usage=function(e,n){return n||"object"!=typeof e||(n=e,e=null),l=e,n&&a.options(n),a};var u=[];a.check=function(e){return u.push(e),a};var f={};a.default=function(e,n){return"object"==typeof e?Object.keys(e).forEach(function(n){a.default(n,e[n])}):f[e]=n,a};var p={};a.describe=function(e,n){return"object"==typeof e?Object.keys(e).forEach(function(n){a.describe(n,e[n])}):p[e]=n,a},a.parse=function(e){return Argv(e).argv},a.option=a.options=function(e,n){if("object"==typeof e)Object.keys(e).forEach(function(n){a.options(n,e[n])});else{n.alias&&a.alias(e,n.alias),n.demand&&a.demand(e),"undefined"!=typeof n.default&&a.default(e,n.default),(n.boolean||"boolean"===n.type)&&a.boolean(e),(n.string||"string"===n.type)&&a.string(e);var r=n.describe||n.description||n.desc;r&&a.describe(e,r)}return a};var h=null;return a.wrap=function(e){return h=e,a},a.showHelp=function(e){e||(e=console.error),e(a.help())},a.help=function(){var e=Object.keys(Object.keys(p).concat(Object.keys(s)).concat(Object.keys(f)).reduce(function(e,n){return"_"!==n&&(e[n]=!0),e},{})),n=e.length?["Options:"]:[];l&&n.unshift(l.replace(/\$0/g,a.$0),"");var r=e.reduce(function(e,n){return e[n]=[n].concat(c[n]||[]).map(function(e){return(e.length>1?"--":"-")+e}).join(", "),e},{}),t=o(Object.keys(r).map(function(e){return r[e]||""})),u=o(Object.keys(p).map(function(e){return p[e]||""}));return e.forEach(function(e){var o=r[e],a=p[e]||"";h&&(a=wordwrap(t+4,h)(a).slice(t+4));var c=new Array(Math.max(t-o.length+3,0)).join(" "),l=new Array(Math.max(u-a.length+1,0)).join(" "),g=null;i.bools[e]&&(g="[boolean]"),i.strings[e]&&(g="[string]"),!h&&l.length>0&&(a+=l);var v="  "+o+c,b=[g,s[e]?"[required]":null,void 0!==f[e]?"[default: "+JSON.stringify(f[e])+"]":null].filter(Boolean).join("  "),y=[a,b].filter(Boolean).join("  ");if(h){var d=a.split("\n"),m=d.slice(-1)[0].length+(1===d.length?v.length:0);y=a+(m+b.length>h-2?"\n"+new Array(h-b.length+1).join(" ")+b:new Array(h-b.length-m+1).join(" ")+b)}n.push(v+y)}),n.push(""),n.join("\n")},Object.defineProperty(a,"argv",{get:t,enumerable:!0}),a}function rebase(e,n){for(var r=path.normalize(n).split("/").slice(1),t=path.normalize(e).split("/").slice(1),o=0;r[o]&&r[o]==t[o];o++);r.splice(0,o),t.splice(0,o);var a=path.normalize(t.map(function(){return".."}).concat(r).join("/")).replace(/\/$/,"").replace(/^$/,".");return a.match(/^[.\/]/)?a:"./"+a}function setKey(e,n,r){var t=e;n.slice(0,-1).forEach(function(e){void 0===t[e]&&(t[e]={}),t=t[e]});var o=n[n.length-1];void 0===t[o]||"boolean"==typeof t[o]?t[o]=r:Array.isArray(t[o])?t[o].push(r):t[o]=[t[o],r]}var path=require("path"),wordwrap=require("wordwrap"),inst=Argv(process.argv.slice(2));Object.keys(inst).forEach(function(e){Argv[e]="function"==typeof inst[e]?inst[e].bind(inst):inst[e]});var exports=module.exports=Argv;exports.rebase=rebase;