"use strict";function array_to_hash(t){for(var n=Object.create(null),r=0;r<t.length;++r)n[t[r]]=!0;return n}function slice(t,n){return Array.prototype.slice.call(t,n||0)}function characters(t){return t.split("")}function member(t,n){for(var r=n.length;--r>=0;)if(n[r]==t)return!0;return!1}function find_if(t,n){for(var r=0,e=n.length;e>r;++r)if(t(n[r]))return n[r]}function repeat_string(t,n){if(0>=n)return"";if(1==n)return t;var r=repeat_string(t,n>>1);return r+=r,1&n&&(r+=t),r}function DefaultsError(t,n){this.msg=t,this.defs=n}function defaults(t,n,r){t===!0&&(t={});var e=t||{};if(r)for(var i in e)if(e.hasOwnProperty(i)&&!n.hasOwnProperty(i))throw new DefaultsError("`"+i+"` is not a supported option",n);for(var i in n)n.hasOwnProperty(i)&&(e[i]=t&&t.hasOwnProperty(i)?t[i]:n[i]);return e}function merge(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t}function noop(){}function push_uniq(t,n){t.indexOf(n)<0&&t.push(n)}function string_template(t,n){return t.replace(/\{(.+?)\}/g,function(t,r){return n[r]})}function remove(t,n){for(var r=t.length;--r>=0;)t[r]===n&&t.splice(r,1)}function mergeSort(t,n){function r(t,r){for(var e=[],i=0,s=0,u=0;i<t.length&&s<r.length;)e[u++]=n(t[i],r[s])<=0?t[i++]:r[s++];return i<t.length&&e.push.apply(e,t.slice(i)),s<r.length&&e.push.apply(e,r.slice(s)),e}function e(t){if(t.length<=1)return t;var n=Math.floor(t.length/2),i=t.slice(0,n),s=t.slice(n);return i=e(i),s=e(s),r(i,s)}return t.length<2?t.slice():e(t)}function set_difference(t,n){return t.filter(function(t){return n.indexOf(t)<0})}function set_intersection(t,n){return t.filter(function(t){return n.indexOf(t)>=0})}function makePredicate(t){function n(t){if(1==t.length)return r+="return str === "+JSON.stringify(t[0])+";";r+="switch(str){";for(var n=0;n<t.length;++n)r+="case "+JSON.stringify(t[n])+":";r+="return true}return false;"}t instanceof Array||(t=t.split(" "));var r="",e=[];t:for(var i=0;i<t.length;++i){for(var s=0;s<e.length;++s)if(e[s][0].length==t[i].length){e[s].push(t[i]);continue t}e.push([t[i]])}if(e.length>3){e.sort(function(t,n){return n.length-t.length}),r+="switch(str.length){";for(var i=0;i<e.length;++i){var u=e[i];r+="case "+u[0].length+":",n(u)}r+="}"}else n(t);return new Function("str",r)}function all(t,n){for(var r=t.length;--r>=0;)if(!n(t[r]))return!1;return!0}function Dictionary(){this._values=Object.create(null),this._size=0}var MAP=function(){function t(t,s,u){function o(){var o=s(t[f],f),h=o instanceof e;return h&&(o=o.v),o instanceof n?(o=o.v,o instanceof r?c.push.apply(c,u?o.v.slice().reverse():o.v):c.push(o)):o!==i&&(o instanceof r?a.push.apply(a,u?o.v.slice().reverse():o.v):a.push(o)),h}var f,a=[],c=[];if(t instanceof Array)if(u){for(f=t.length;--f>=0&&!o(););a.reverse(),c.reverse()}else for(f=0;f<t.length&&!o();++f);else for(f in t)if(t.hasOwnProperty(f)&&o())break;return c.concat(a)}function n(t){this.v=t}function r(t){this.v=t}function e(t){this.v=t}t.at_top=function(t){return new n(t)},t.splice=function(t){return new r(t)},t.last=function(t){return new e(t)};var i=t.skip={};return t}();Dictionary.prototype={set:function(t,n){return this.has(t)||++this._size,this._values["$"+t]=n,this},add:function(t,n){return this.has(t)?this.get(t).push(n):this.set(t,[n]),this},get:function(t){return this._values["$"+t]},del:function(t){return this.has(t)&&(--this._size,delete this._values["$"+t]),this},has:function(t){return"$"+t in this._values},each:function(t){for(var n in this._values)t(this._values[n],n.substr(1))},size:function(){return this._size},map:function(t){var n=[];for(var r in this._values)n.push(t(this._values[r],r.substr(1)));return n}};